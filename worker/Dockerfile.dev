# Development Dockerfile for Buun Curator Backend
#
# Uses official Playwright Python image which includes:
# - Python 3.12 (Ubuntu Noble)
# - Playwright browsers pre-installed at /ms-playwright
# - All browser dependencies

FROM mcr.microsoft.com/playwright/python:v1.57.0-noble

# Install uv
COPY --from=ghcr.io/astral-sh/uv:latest /uv /usr/local/bin/uv

WORKDIR /app

# Copy dependency files
COPY pyproject.toml uv.lock README.md ./

# Install dependencies including dev dependencies
RUN uv sync --frozen

# Set environment variables
ENV PATH="/app/.venv/bin:$PATH"
ENV PYTHONUNBUFFERED=1

# Copy application code (will be overridden by volume mount in dev)
COPY . .

# Default command: start the Temporal worker
ENTRYPOINT ["python", "-m", "buun_curator.worker"]
